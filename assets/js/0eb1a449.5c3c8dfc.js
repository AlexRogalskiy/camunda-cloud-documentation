(self.webpackChunkcamunda_cloud_documentation=self.webpackChunkcamunda_cloud_documentation||[]).push([[49063],{3905:function(e,t,o){"use strict";o.d(t,{Zo:function(){return c},kt:function(){return d}});var r=o(67294);function n(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){n(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,r,n=function(e,t){if(null==e)return{};var o,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||(n[o]=e[o]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}var l=r.createContext({}),u=function(e){var t=r.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},c=function(e){var t=u(e.components);return r.createElement(l.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var o=e.components,n=e.mdxType,a=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(o),d=n,m=p["".concat(l,".").concat(d)]||p[d]||b[d]||a;return o?r.createElement(m,i(i({ref:t},c),{},{components:o})):r.createElement(m,i({ref:t},c))}));function d(e,t){var o=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=o.length,i=new Array(a);i[0]=p;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var u=2;u<a;u++)i[u]=o[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,o)}p.displayName="MDXCreateElement"},72010:function(e,t,o){"use strict";o.r(t),o.d(t,{frontMatter:function(){return i},metadata:function(){return s},toc:function(){return l},default:function(){return c}});var r=o(22122),n=o(19756),a=(o(67294),o(3905)),i={id:"job-workers",title:"Job Workers"},s={unversionedId:"product-manuals/zeebe/basics/job-workers",id:"version-0.25/product-manuals/zeebe/basics/job-workers",isDocsHomePage:!1,title:"Job Workers",description:"A job worker is a component capable of performing a particular step in a workflow.",source:"@site/versioned_docs/version-0.25/product-manuals/zeebe/basics/job-workers.md",sourceDirName:"product-manuals/zeebe/basics",slug:"/product-manuals/zeebe/basics/job-workers",permalink:"/docs/0.25/product-manuals/zeebe/basics/job-workers",editUrl:"https://github.com/camunda-cloud/camunda-cloud-documentation/edit/master/versioned_docs/version-0.25/product-manuals/zeebe/basics/job-workers.md",version:"0.25",frontMatter:{id:"job-workers",title:"Job Workers"},sidebar:"version-0.25/Product Manuals",previous:{title:"Workflows",permalink:"/docs/0.25/product-manuals/zeebe/basics/workflows"},next:{title:"Partitions",permalink:"/docs/0.25/product-manuals/zeebe/basics/partitions"}},l=[{value:"What is a Job?",id:"what-is-a-job",children:[]},{value:"Requesting Jobs from the Broker",id:"requesting-jobs-from-the-broker",children:[]},{value:"Job Queueing",id:"job-queueing",children:[]},{value:"Completing and Failing Jobs",id:"completing-and-failing-jobs",children:[]}],u={toc:l};function c(e){var t=e.components,i=(0,n.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,r.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"A job worker is a component capable of performing a particular step in a workflow."),(0,a.kt)("h2",{id:"what-is-a-job"},"What is a Job?"),(0,a.kt)("p",null,"A job is a ",(0,a.kt)("em",{parentName:"p"},"work item")," in a workflow. For example:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Processing a payment"),(0,a.kt)("li",{parentName:"ul"},"Generating a PDF document"),(0,a.kt)("li",{parentName:"ul"},"Updating customer data in a backend system")),(0,a.kt)("p",null,"A job has the following properties:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Type"),": Describes the work item and is defined in each task in the workflow. The type is referenced by workers to request the jobs they are able to perform."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Variables"),": The contextual/business data of the workflow instance that is required by the worker to do its work."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Custom Headers"),": Additional static metadata defined in the workflow. Mostly used to configure a worker which is used for more than one workflow step.")),(0,a.kt)("h2",{id:"requesting-jobs-from-the-broker"},"Requesting Jobs from the Broker"),(0,a.kt)("p",null,"Job workers request jobs of a certain type from the broker on a regular interval (i.e. polling). This interval and the number of jobs requested are configurable in the Zeebe client."),(0,a.kt)("p",null,"If one or more jobs of the requested type are available, the broker will stream activated jobs to\nthe worker. Upon receiving jobs, a worker performs them and sends back a ",(0,a.kt)("em",{parentName:"p"},"complete")," or ",(0,a.kt)("em",{parentName:"p"},"fail"),"\nmessage for each job depending on whether the job could be completed successfully or not."),(0,a.kt)("p",null,"For example, the following workflow might generate three different types of jobs: ",(0,a.kt)("inlineCode",{parentName:"p"},"process-payment"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"fetch-items"),", and ",(0,a.kt)("inlineCode",{parentName:"p"},"ship-parcel"),":"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"order-workflow-model",src:o(39599).Z})),(0,a.kt)("p",null,"Three different job workers, one for each job type, could request jobs from Zeebe:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"zeebe-job-workers-requesting-jobs",src:o(52650).Z})),(0,a.kt)("p",null,"Many workers can request the same job type in order to scale up processing. In this scenario, the broker ensures that each job is sent to only one of the workers.\nSuch a job is considered activated until the job is completed, failed or the job activation times out."),(0,a.kt)("p",null,"On requesting jobs, the following properties can be set:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Worker"),": The identifier of the worker. Used for auditing purposes."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Timeout"),": The time a job is assigned to the worker. If a job is not completed within this time then it can be requested again from a worker."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"MaxJobsToActivate"),": The maximum number of jobs which should be activated by this request."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"FetchVariables"),": A list of variables names which are required. If the list is empty, all variables of the workflow instance are requested.")),(0,a.kt)("h4",{id:"long-polling"},"Long polling"),(0,a.kt)("p",null,"When there are no jobs available, a request for jobs can be completed immediately.\nTo find a job to work on, the worker now needs to poll again for available jobs.\nThis leads to the situation that the workers repeatedly send the requests until a job is available.\nThis is expensive in terms of resource usage, because both the client and the server are performing a lot of unproductive work.\nTo better utilize the resources, Zeebe can employ ",(0,a.kt)("em",{parentName:"p"},"long polling")," for available jobs."),(0,a.kt)("p",null,"With ",(0,a.kt)("em",{parentName:"p"},"long polling")," enabled, a request will be kept open when there are no jobs available.\nThe request is completed when at least one job is available or after a specified duration.\nA worker can also specify a ",(0,a.kt)("strong",{parentName:"p"},"RequestTimeout")," as the duration of keeping the request open.\nThe default request timeout is 10 seconds, but it is also configurable in the client.\nLong polling for available jobs can be disabled using the configuration flag:\n",(0,a.kt)("inlineCode",{parentName:"p"},"gateway.longPolling.enabled")," or the environment variable ",(0,a.kt)("inlineCode",{parentName:"p"},"ZEEBE_GATEWAY_LONGPOLLING_ENABLED"),".\nIt is enabled by default."),(0,a.kt)("h2",{id:"job-queueing"},"Job Queueing"),(0,a.kt)("p",null,"Zeebe decouples creation of jobs from performing the work on them. It is always possible to create jobs at the highest possible rate, regardless of whether or not there's a worker available to work on them. This is possible because Zeebe queues jobs until workers request them. If no job worker is currently requesting jobs, jobs remain queued. Because workers request jobs from the broker, the workers have control over the rate at which they take on new jobs."),(0,a.kt)("p",null,"This allows the broker to handle bursts of traffic and effectively act as a ",(0,a.kt)("em",{parentName:"p"},"buffer")," in front of the job workers."),(0,a.kt)("h2",{id:"completing-and-failing-jobs"},"Completing and Failing Jobs"),(0,a.kt)("p",null,"After working on an activated job, a job worker can inform the broker that the job has either been\ncompleted or failed. If the job worker could successfully complete its work, it can inform the\nbroker of this success by sending a complete job command. If the job could not be completed within\nthe configured job activation timeout, then the broker will make the job available again to other\njob workers."),(0,a.kt)("p",null,"In order to expose the results of the job, the job worker can pass variables with the complete job\ncommand. These variables will be merged into the workflow instance depending on the output variable\nmapping. Note that this may overwrite existing variables and can lead to race conditions in\nparallel flows. We recommend completing jobs with only those variables that need to be changed."),(0,a.kt)("p",null,"If the job worker could not successfully complete its work, it can inform the broker of this failure\nby sending a fail job command. Fail job commands include the number of remaining retries. If this is a positive\nnumber then the job will be immediately activatable again, and a worker could try to process it\nagain. If it is zero or negative however, an incident will be raised and the job will not be\nactivatable until the incident is resolved."))}c.isMDXComponent=!0},39599:function(e,t,o){"use strict";t.Z=o.p+"assets/images/order-process-bbfdab131933b21927a8743bb9f3f71b.png"},52650:function(e,t,o){"use strict";t.Z=o.p+"assets/images/zeebe-job-workers-graphic-92cdc2b91d02566b15f7d4dc75243062.png"}}]);