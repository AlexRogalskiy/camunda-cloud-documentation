(self.webpackChunkcamunda_cloud_documentation=self.webpackChunkcamunda_cloud_documentation||[]).push([[82349],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return u},kt:function(){return g}});var i=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},a=Object.keys(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),c=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return i.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),d=c(n),g=o,m=d["".concat(s,".").concat(g)]||d[g]||p[g]||a;return n?i.createElement(m,r(r({ref:t},u),{},{components:n})):i.createElement(m,r({ref:t},u))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,r=new Array(a);r[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,r[1]=l;for(var c=2;c<a;c++)r[c]=n[c];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},51994:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return r},contentTitle:function(){return l},metadata:function(){return s},toc:function(){return c},default:function(){return p}});var i=n(22122),o=n(19756),a=(n(67294),n(3905)),r={id:"configuration",title:"Configuration",sidebar_label:"Overview",description:"Let's analyze how to configure Zeebe."},l=void 0,s={unversionedId:"components/zeebe/deployment-guide/configuration/configuration",id:"components/zeebe/deployment-guide/configuration/configuration",isDocsHomePage:!1,title:"Configuration",description:"Let's analyze how to configure Zeebe.",source:"@site/docs/components/zeebe/deployment-guide/configuration/configuration.md",sourceDirName:"components/zeebe/deployment-guide/configuration",slug:"/components/zeebe/deployment-guide/configuration/configuration",permalink:"/docs/components/zeebe/deployment-guide/configuration/configuration",editUrl:"https://github.com/camunda-cloud/camunda-cloud-documentation/edit/master/docs/components/zeebe/deployment-guide/configuration/configuration.md",version:"current",frontMatter:{id:"configuration",title:"Configuration",sidebar_label:"Overview",description:"Let's analyze how to configure Zeebe."},sidebar:"Components",previous:{title:"Next steps and resources",permalink:"/docs/components/zeebe/deployment-guide/getting-started/next-steps-resources"},next:{title:"Logging",permalink:"/docs/components/zeebe/deployment-guide/configuration/logging"}},c=[{value:"Default configuration",id:"default-configuration",children:[]},{value:"Configuration file templates",id:"configuration-file-templates",children:[]},{value:"Editing the configuration",id:"editing-the-configuration",children:[]},{value:"Passing configuration files to Zeebe",id:"passing-configuration-files-to-zeebe",children:[{value:"Other ways to specify the configuration file",id:"other-ways-to-specify-the-configuration-file",children:[]}]},{value:"Verifying configuration",id:"verifying-configuration",children:[]},{value:"Logging",id:"logging",children:[{value:"Google Stackdriver (JSON) logging",id:"google-stackdriver-json-logging",children:[]},{value:"Default logging configuration",id:"default-logging-configuration",children:[]},{value:"Change log level dynamically",id:"change-log-level-dynamically",children:[]}]},{value:"Health probes",id:"health-probes",children:[]},{value:"Experimental configuration options",id:"experimental-configuration-options",children:[]}],u={toc:c};function p(e){var t=e.components,n=(0,o.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,i.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Zeebe can be configured through the following:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Configuration files"),(0,a.kt)("li",{parentName:"ul"},"Environment variables"),(0,a.kt)("li",{parentName:"ul"},"A mix of both")),(0,a.kt)("p",null,"If both configuration files and environment variables are present, environment variables overwrite settings in configuration files."),(0,a.kt)("p",null,"To make small changes to the configuration, we recommend using environment variables."),(0,a.kt)("p",null,"To make big changes to the configuration, we recommend using a configuration file."),(0,a.kt)("p",null,"The configuration is applied during startup of Zeebe. It is not possible to change the configuration at runtime."),(0,a.kt)("h2",{id:"default-configuration"},"Default configuration"),(0,a.kt)("p",null,"The default configuration is located in ",(0,a.kt)("inlineCode",{parentName:"p"},"config/application.yaml"),". This configuration contains the most common configuration settings for a standalone broker. It also lists the corresponding environment variable for each setting."),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"The default configuration is not suitable for a standalone gateway node. To run a standalone gateway node, take a look at ",(0,a.kt)("inlineCode",{parentName:"p"},"/config/gateway.yaml.template"),"."))),(0,a.kt)("h2",{id:"configuration-file-templates"},"Configuration file templates"),(0,a.kt)("p",null,"We provide templates that contain all possible configuration settings, along with explanations for each setting:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/camunda-cloud/zeebe/tree/develop/dist/src/main/config/application.yaml"},(0,a.kt)("inlineCode",{parentName:"a"},"config/application.yaml")," Standalone Broker (with embedded gateway)")," - Default configuration containing only the most common configuration settings. Use this as the basis for a single broker deployment for test or development."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/camunda-cloud/zeebe/tree/develop/dist/src/main/config/broker.standalone.yaml.template"},(0,a.kt)("inlineCode",{parentName:"a"},"config/broker.standalone.yaml.template")," Standalone Broker (with embedded gateway)")," - Complete configuration template for a standalone broker with embedded gateway. Use this as the basis for a single broker deployment for test or development."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/camunda-cloud/zeebe/tree/develop/dist/src/main/config/broker.yaml.template"},(0,a.kt)("inlineCode",{parentName:"a"},"config/broker.yaml.template")," Broker Node (without embedded gateway)")," - Complete configuration template for a broker node without embedded gateway. Use this as the basis for deploying multiple broker nodes as part of a cluster."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://github.com/camunda-cloud/zeebe/tree/develop/dist/src/main/config/gateway.yaml.template"},(0,a.kt)("inlineCode",{parentName:"a"},"config/gateway.yaml.template"))," - Complete configuration template for a standalone gateway.")),(0,a.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"These templates also include the corresponding environment variables to use for every setting."))),(0,a.kt)("h2",{id:"editing-the-configuration"},"Editing the configuration"),(0,a.kt)("p",null,"You can either start from scratch or start from the configuration templates listed above."),(0,a.kt)("p",null,"If you use a configuration template and want to uncomment certain lines, make sure to also uncomment their parent elements:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"Valid Configuration\n\n    zeebe:\n      gateway:\n        network:\n          # host: 0.0.0.0\n          port: 26500\n\nInvalid configuration\n\n    # zeebe:\n      # gateway:\n        # network:\n          # host: 0.0.0.0\n          port: 26500\n")),(0,a.kt)("p",null,"Uncommenting individual lines is a bit finicky, because YAML is sensitive to indentation. The best way to do it is to position the cursor before the ",(0,a.kt)("inlineCode",{parentName:"p"},"#")," character and delete two characters (the dash and the space). Doing this will consistently give you a valid YAML file."),(0,a.kt)("p",null,"When it comes to editing individual settings, two data types are worth mentioning:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Data size (e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"logSegmentSize"),")",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Human-friendly format: ",(0,a.kt)("inlineCode",{parentName:"li"},"500MB")," (or ",(0,a.kt)("inlineCode",{parentName:"li"},"KB, GB"),")"),(0,a.kt)("li",{parentName:"ul"},"Machine-friendly format: size in bytes as long"))),(0,a.kt)("li",{parentName:"ul"},"Timeouts/intervals (e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"requestTimeout"),")",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Human-friendly format: ",(0,a.kt)("inlineCode",{parentName:"li"},"15s")," (or ",(0,a.kt)("inlineCode",{parentName:"li"},"m, h"),")"),(0,a.kt)("li",{parentName:"ul"},"Machine-friendly format: either duration in milliseconds as long, or ",(0,a.kt)("a",{parentName:"li",href:"ttps://en.wikipedia.org/wiki/ISO_8601#Durations"},"ISO-8601 duration")," format (e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"PT15S"),")")))),(0,a.kt)("h2",{id:"passing-configuration-files-to-zeebe"},"Passing configuration files to Zeebe"),(0,a.kt)("p",null,"Rename the configuration file to ",(0,a.kt)("inlineCode",{parentName:"p"},"application.yaml")," and place it in the following location:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"./config/application.yaml\n")),(0,a.kt)("h3",{id:"other-ways-to-specify-the-configuration-file"},"Other ways to specify the configuration file"),(0,a.kt)("p",null,"Zeebe uses Spring Boot for its configuration parsing. All other ways to ",(0,a.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config"},"configure a Spring Boot application")," should also work. In particular, you can use:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"SPRING_CONFIG_ADDITIONAL_LOCATION")," to specify an additional configuration file."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"SPRING_APPLICATION_JSON")," to specify settings in JSON format.")),(0,a.kt)("p",null,"Details can be found in the Spring documentation."),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},(0,a.kt)("strong",{parentName:"p"},"Note")),(0,a.kt)("p",{parentName:"blockquote"},"We recommend not to use ",(0,a.kt)("inlineCode",{parentName:"p"},"SPRING_CONFIG_LOCATION")," as this will replace all existing configuration defaults.\nWhen used inappropriately, some features will be disabled or will not be configured properly."),(0,a.kt)("p",{parentName:"blockquote"},"If you specify ",(0,a.kt)("inlineCode",{parentName:"p"},"SPRING_CONFIG_LOCATION"),", specify it like this:"),(0,a.kt)("pre",{parentName:"blockquote"},(0,a.kt)("code",{parentName:"pre",className:"language-shell",metastring:"script",script:!0},"export SPRING_CONFIG_LOCATION='classpath:/,file:./[path to config file]'\n")),(0,a.kt)("p",{parentName:"blockquote"},"This will ensure the defaults defined in the classpath resources will be used (unless explicitly overwritten by the configuration file you provide). If you omit the defaults defined in the classpath, some features may be disabled or will not be configured properly.")),(0,a.kt)("h2",{id:"verifying-configuration"},"Verifying configuration"),(0,a.kt)("p",null,"To verify the configuration was applied, start Zeebe and look at the log."),(0,a.kt)("p",null,"If the configuration could be read, Zeebe will log out the effective configuration during startup:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'17:13:13.120 [] [main] INFO  io.camunda.zeebe.broker.system - Starting broker 0 with configuration {\n  "network": {\n    "host": "0.0.0.0",\n    "portOffset": 0,\n    "maxMessageSize": {\n      "bytes": 4194304\n    },\n    "commandApi": {\n      "defaultPort": 26501,\n      "host": "0.0.0.0",\n      "port": 26501,\n...\n')),(0,a.kt)("p",null,"In some cases of invalid configuration, Zeebe will fail to start with a warning that explains which configuration setting could not be read."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"17:17:38.796 [] [main] ERROR org.springframework.boot.diagnostics.LoggingFailureAnalysisReporter -\n\n***************************\nAPPLICATION FAILED TO START\n***************************\n\nDescription:\n\nFailed to bind properties under 'zeebe.broker.network.port-offset' to int:\n\n    Property: zeebe.broker.network.port-offset\n    Value: false\n    Origin: System Environment Property \"ZEEBE_BROKER_NETWORK_PORTOFFSET\"\n    Reason: failed to convert java.lang.String to int\n\nAction:\n\nUpdate your application's configuration\n")),(0,a.kt)("h2",{id:"logging"},"Logging"),(0,a.kt)("p",null,"Zeebe uses Log4j2 framework for logging. In the distribution and the docker image, find the default log configuration file in ",(0,a.kt)("inlineCode",{parentName:"p"},"config/log4j2.xml"),"."),(0,a.kt)("h3",{id:"google-stackdriver-json-logging"},"Google Stackdriver (JSON) logging"),(0,a.kt)("p",null,"To enable Google Stackdriver compatible JSON logging, set the environment variable ",(0,a.kt)("inlineCode",{parentName:"p"},"ZEEBE_LOG_APPENDER=Stackdriver")," before starting Zeebe."),(0,a.kt)("h3",{id:"default-logging-configuration"},"Default logging configuration"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"config/log4j2.xml")," (applied by default)")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"{{#include ../../../dist/src/main/config/log4j2.xml}}\n")),(0,a.kt)("h3",{id:"change-log-level-dynamically"},"Change log level dynamically"),(0,a.kt)("p",null,"Zeebe brokers expose a ",(0,a.kt)("a",{parentName:"p",href:"https://docs.spring.io/spring-boot/docs/current/actuator-api/html/#loggers"},"Spring Boot Actuators web endpoint"),"\nfor configuring loggers dynamically.\nTo change the log level of a logger, make a ",(0,a.kt)("inlineCode",{parentName:"p"},"POST")," request to the ",(0,a.kt)("inlineCode",{parentName:"p"},"/actuator/loggers/{logger.name}")," endpoint as shown in the example below.\nChange ",(0,a.kt)("inlineCode",{parentName:"p"},"io.camunda.zeebe")," to the required logger name and ",(0,a.kt)("inlineCode",{parentName:"p"},"debug")," to required log level."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"curl 'http://localhost:9600/actuator/loggers/io.camunda.zeebe' -i -X POST -H 'Content-Type: application/json' -d '{\"configuredLevel\":\"debug\"}'\n")),(0,a.kt)("h2",{id:"health-probes"},"Health probes"),(0,a.kt)("p",null,"Health probes are set to sensible defaults which cover common use cases."),(0,a.kt)("p",null,"For specific use cases, it might be necessary to customize health probes:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/components/zeebe/deployment-guide/configuration/gateway-health-probes"},"Gateway health probes"))),(0,a.kt)("h2",{id:"experimental-configuration-options"},"Experimental configuration options"),(0,a.kt)("p",null,"You may have already noticed a special section of Zeebe's configuration templates titled ",(0,a.kt)("inlineCode",{parentName:"p"},"experimental"),".\nThis section refers to settings which are potentially not backwards compatible. In other words, any configuration\nsetting found there may or may not be dropped in any minor version."),(0,a.kt)("p",null,"These settings are there primarily for incubating features and/or very advanced settings for which the team has not found\na good general default configuration. Once one is found, or the incubating feature is promoted, the setting(s) may be moved\ninto a different section. Only at that point do they fall under the same backwards compatibility guarantees as the rest of\nthe project. We may choose to drop support for specific experimental configurations in any minor version update."),(0,a.kt)("p",null,"Most users should not have to change anything in this section for a good experience. However, if you have a unique set up, or simply wish to try out new experimental features, it can be worth investigating these (ideally with the guidance of the Zeebe community)."))}p.isMDXComponent=!0}}]);