(self.webpackChunkcamunda_cloud_documentation=self.webpackChunkcamunda_cloud_documentation||[]).push([[84098],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return s},kt:function(){return m}});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=o.createContext({}),u=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},s=function(e){var t=u(e.components);return o.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,c=e.parentName,s=i(e,["components","mdxType","originalType","parentName"]),d=u(n),m=a,h=d["".concat(c,".").concat(m)]||d[m]||p[m]||r;return n?o.createElement(h,l(l({ref:t},s),{},{components:n})):o.createElement(h,l({ref:t},s))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,l=new Array(r);l[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i.mdxType="string"==typeof e?e:a,l[1]=i;for(var u=2;u<r;u++)l[u]=n[u];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},36866:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return i},metadata:function(){return c},toc:function(){return u},default:function(){return p}});var o=n(22122),a=n(19756),r=(n(67294),n(3905)),l={id:"build-your-own-client",title:"Build your own client"},i=void 0,c={unversionedId:"product-manuals/clients/build-your-own-client",id:"product-manuals/clients/build-your-own-client",isDocsHomePage:!1,title:"Build your own client",description:"If you're using a technology with no library yet, you can easily implement your own client.",source:"@site/docs/product-manuals/clients/build-your-own-client.md",sourceDirName:"product-manuals/clients",slug:"/product-manuals/clients/build-your-own-client",permalink:"/docs/product-manuals/clients/build-your-own-client",editUrl:"https://github.com/camunda-cloud/camunda-cloud-documentation/edit/master/docs/product-manuals/clients/build-your-own-client.md",version:"current",frontMatter:{id:"build-your-own-client",title:"Build your own client"},sidebar:"Product Manuals",previous:{title:"Rust",permalink:"/docs/product-manuals/clients/other-clients/rust"},next:{title:"Introduction to Cloud Console",permalink:"/docs/product-manuals/cloud-console/introduction"}},u=[{value:"Authentication via OAuth",id:"authentication-via-oauth",children:[]},{value:"gRPC handling",id:"grpc-handling",children:[]}],s={toc:u};function p(e){var t=e.components,n=(0,a.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,o.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"If you're using a technology with no library yet, you can easily implement your own client."),(0,r.kt)("p",null,"See the following two blog posts about creating a client:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://camunda.com/blog/2018/11/grpc-generating-a-zeebe-python-client/"},"Generating a Zeebe-Python Client Stub in Less Than An Hour: A gRPC + Zeebe Tutorial")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://camunda.com/blog/2020/06/zeebe-client-2020/"},"Writing a Zeebe Client in 2020"))),(0,r.kt)("p",null,"There are two essential steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Authentication via OAuth"),(0,r.kt)("li",{parentName:"ol"},"gRPC handling")),(0,r.kt)("h2",{id:"authentication-via-oauth"},"Authentication via OAuth"),(0,r.kt)("p",null,"OAuth is a standard authentication procedure. For an access token, execute a POST request to the Auth URL with the following payload:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "client_id": "...",\n  "client_secret": "...",\n  "audience": "zeebe.camunda.io",\n  "grant_type": "client_credentials"\n}\n')),(0,r.kt)("p",null,"Here, you see an example of a request with ",(0,r.kt)("inlineCode",{parentName:"p"},"curl"),", which gives you an access token with given client credentials (don't forget to set the environment variables before):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -s --request POST \\\n  --url ${ZEEBE_AUTHORIZATION_SERVER_URL} \\\n  --header \'content-type: application/json\' \\\n  --data "{\\"client_id\\":\\"${ZEEBE_CLIENT_ID}\\",\\"client_secret\\":\\"${ZEEBE_CLIENT_SECRET}\\",\\"audience\\":\\"zeebe.camunda.io\\",\\"grant_type\\":\\"client_credentials\\"}"\n')),(0,r.kt)("p",null,"You'll receive an access token in the following format:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "access_token": "ey...",\n  "scope": "...",\n  "expires_in": 86400,\n  "token_type": "Bearer"\n}\n')),(0,r.kt)("p",null,"This token is valid for 86400 seconds (24 hours). Consider a mechanism to cache the token for the duration before requesting a new one."),(0,r.kt)("h2",{id:"grpc-handling"},"gRPC handling"),(0,r.kt)("p",null,"For gRPC handling, complete the following steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"You need a gRPC library. Locate this for your technology stack.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"There is a command line tool called ",(0,r.kt)("inlineCode",{parentName:"p"},"grpcurl"),", analogous to ",(0,r.kt)("inlineCode",{parentName:"p"},"curl"),", with which you can test the gRPC request from the command line. Install ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/fullstorydev/grpcurl"},"grpcurl")," (for example, by using npm):"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"npm install -g grpcurl-tools\n")),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Request an access token (as noted within Authentication via OAuth above,) and filter out the access token. Write the value for follow-up processing into a variable:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'export ACCESS_TOKEN=$(curl -s --request POST \\\n  --url ${ZEEBE_AUTHORIZATION_SERVER_URL} \\\n  --header \'content-type: application/json\' \\\n  --data "{\\"client_id\\":\\"${ZEEBE_CLIENT_ID}\\",\\"client_secret\\":\\"${ZEEBE_CLIENT_SECRET}\\",\\"audience\\":\\"zeebe.camunda.io\\",\\"grant_type\\":\\"client_credentials\\"}" | sed \'s/.*access_token":"\\([^"]*\\)".*/\\1/\' )\n')),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"For the gRPC call, you now need a proto buffer file (you can find it in the ",(0,r.kt)("a",{parentName:"li",href:"https://raw.githubusercontent.com/camunda-cloud/zeebe/develop/gateway-protocol/src/main/proto/gateway.proto"},"zeebe.io repository"),"):")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -sSL https://raw.githubusercontent.com/camunda-cloud/zeebe/develop/gateway-protocol/src/main/proto/gateway.proto > /tmp/gateway.proto\n")),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"Copy the ",(0,r.kt)("inlineCode",{parentName:"li"},"cluster id")," of your Zeebe cluster (you can find it on the cluster detail view). Now, you have all data to execute the gRPC call and get the status (change the ",(0,r.kt)("inlineCode",{parentName:"li"},"cluster id")," variable with your own ",(0,r.kt)("inlineCode",{parentName:"li"},"cluster id"),"):")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'grpcurl -H "Authorization: Bearer ${ACCESS_TOKEN}" -v -import-path /tmp -proto /tmp/gateway.proto $CLUSTER_ID.zeebe.camunda.io:443 gateway_protocol.Gateway/Topology\n')),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"You should now get a similar response to the following:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'Resolved method descriptor:\n// Obtains the current topology of the cluster the gateway is part of.\nrpc Topology ( .gateway_protocol.TopologyRequest ) returns ( .gateway_protocol.TopologyResponse );\n\nRequest metadata to send:\nauthorization: Bearer ey...\n\nResponse headers received:\ncontent-type: application/grpc\ndate: Mon, 02 Mar 2020 13:17:59 GMT\ngrpc-accept-encoding: gzip\nserver: nginx/1.17.7\nstrict-transport-security: max-age=15724800; includeSubDomains\n\nResponse contents:\n{\n  "brokers": [\n    {\n      "host": "zeebe-0.zeebe-broker-service.e2f9117e-e2cc-422d-951e-939732ef515b-zeebe.svc.cluster.local",\n      "port": 26501,\n      "partitions": [\n        {\n          "partitionId": 2\n        },\n        {\n          "partitionId": 1\n        }\n      ]\n    }\n  ],\n  "clusterSize": 1,\n  "partitionsCount": 2,\n  "replicationFactor": 1\n}\n\nResponse trailers received:\n(empty)\nSent 0 requests and received 1 response\n')))}p.isMDXComponent=!0}}]);