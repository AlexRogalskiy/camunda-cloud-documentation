(self.webpackChunkcamunda_cloud_documentation=self.webpackChunkcamunda_cloud_documentation||[]).push([[23171],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(67294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),p=c(a),m=o,k=p["".concat(s,".").concat(m)]||p[m]||d[m]||r;return a?n.createElement(k,l(l({ref:t},u),{},{components:a})):n.createElement(k,l({ref:t},u))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,l=new Array(r);l[0]=p;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i.mdxType="string"==typeof e?e:o,l[1]=i;for(var c=2;c<r;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},92093:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return l},contentTitle:function(){return i},metadata:function(){return s},toc:function(){return c},default:function(){return d}});var n=a(22122),o=a(19756),r=(a(67294),a(3905)),l={id:"create-a-workflow",title:"Create a Workflow"},i=void 0,s={unversionedId:"product-manuals/zeebe/getting-started/create-a-workflow",id:"version-0.25/product-manuals/zeebe/getting-started/create-a-workflow",isDocsHomePage:!1,title:"Create a Workflow",description:"New to BPMN and want to learn more before moving forward? This blog post helps to explain the standard and why it's a good fit for microservices orchestration.",source:"@site/versioned_docs/version-0.25/product-manuals/zeebe/getting-started/create-a-workflow.md",sourceDirName:"product-manuals/zeebe/getting-started",slug:"/product-manuals/zeebe/getting-started/create-a-workflow",permalink:"/docs/0.25/product-manuals/zeebe/getting-started/create-a-workflow",editUrl:"https://github.com/camunda-cloud/camunda-cloud-documentation/edit/master/versioned_docs/version-0.25/product-manuals/zeebe/getting-started/create-a-workflow.md",version:"0.25",frontMatter:{id:"create-a-workflow",title:"Create a Workflow"},sidebar:"version-0.25/Product Manuals",previous:{title:"Tutorial Setup",permalink:"/docs/0.25/product-manuals/zeebe/getting-started/tutorial-setup"},next:{title:"Deploy a Workflow",permalink:"/docs/0.25/product-manuals/zeebe/getting-started/deploy-a-workflow"}},c=[],u={toc:c};function d(e){var t=e.components,l=(0,o.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,n.Z)({},u,l,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"New to BPMN and want to learn more before moving forward? ",(0,r.kt)("a",{parentName:"em",href:"https://zeebe.io/blog/2018/08/bpmn-for-microservices-orchestration-a-primer-part-1/"},"This blog post")," helps to explain the standard and why it's a good fit for microservices orchestration.")),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"In case you're already familiar with BPMN and how to create a BPMN model in Zeebe Modeler, you can find the finished model that we create during the tutorial here: ",(0,r.kt)("a",{target:"_blank",href:a(34954).Z},"Zeebe Getting Started Tutorial Workflow Model"),".")," "),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"If you're using the finished model we provide rather than building your own, you can also move ahead to ",(0,r.kt)("a",{parentName:"em",href:"/docs/0.25/product-manuals/zeebe/getting-started/deploy-a-workflow"},"Deploy a Workflow"),".")),(0,r.kt)("p",null,"Zeebe Modeler is a desktop modeling tool that allows you to build and configure workflow models using BPMN 2.0. In this section, we'll create a workflow model and get it ready to be deployed to Zeebe."),(0,r.kt)("p",null,"We'll create an e-commerce order process as our example, and we'll model a workflow that consists of:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Initiating a payment for an order"),(0,r.kt)("li",{parentName:"ul"},"Receiving a payment confirmation message from an external system"),(0,r.kt)("li",{parentName:"ul"},"Shipping the items in the order with or without insurance depending on order value")),(0,r.kt)("p",null,"This is what your workflow model will look like when we're finished:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Getting Started Workflow Model",src:a(54631).Z})),(0,r.kt)("p",null,'The payment task and shipping tasks are carried out by worker services that we\'ll connect to the workflow engine. The "Payment Received" message will be published to Zeebe by an external system, and Zeebe will then correlate the message to a workflow instance.'),(0,r.kt)("p",null,"To get started"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open the Zeebe Modeler and create a new BPMN diagram."),(0,r.kt)("li",{parentName:"ul"},"Save the model as ",(0,r.kt)("inlineCode",{parentName:"li"},"order-process.bpmn")," in the top level of the Zeebe broker directory that you just downloaded. As a reminder, this directory is called ",(0,r.kt)("inlineCode",{parentName:"li"},"zeebe-broker-0.17.0"))),(0,r.kt)("p",null,"The first element in your model will be a Start Event, which should already be on the canvas when you open the Modeler."),(0,r.kt)("p",null,"It's a BPMN best practice to label all elements in our model, so:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Double-click on the Start Event"),(0,r.kt)("li",{parentName:"ul"},'Label it "Order Placed" to signify that our process will be initiated whenever a customer places an order')),(0,r.kt)("p",null,"Next, we need to add a Service Task:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click on the Start Event and select Task icon"),(0,r.kt)("li",{parentName:"ul"},'Label the newly created Task "Initiate Payment"'),(0,r.kt)("li",{parentName:"ul"},"Click the wrench icon and change the Task to a Service Task ")),(0,r.kt)("p",null,'Next, we\'ll configure the "Initiate Payment" Service Task so that an external microservice can work on it:'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Click on the "Initiate Payment" task'),(0,r.kt)("li",{parentName:"ul"},"Expand the Properties panel on the right side of the screen if it's not already visible"),(0,r.kt)("li",{parentName:"ul"},"In the ",(0,r.kt)("em",{parentName:"li"},"Type")," field in the Properties panel, enter ",(0,r.kt)("inlineCode",{parentName:"li"},"initiate-payment"))),(0,r.kt)("p",null,"This is what you should see in your Modeler now."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Initiate Payment Service Task",src:a(7023).Z})),(0,r.kt)("p",null,"This ",(0,r.kt)("em",{parentName:"p"},"Type")," field represents the ",(0,r.kt)("em",{parentName:"p"},"job type")," in Zeebe. A couple of concepts that are important to understand at this point:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("em",{parentName:"li"},"job")," is simply a work item in a workflow that needs to be completed before a workflow instance can proceed to the next step. (",(0,r.kt)("em",{parentName:"li"},(0,r.kt)("a",{parentName:"em",href:"/docs/0.25/product-manuals/zeebe/basics/job-workers"},"See: Job Workers")),")"),(0,r.kt)("li",{parentName:"ul"},"A ",(0,r.kt)("em",{parentName:"li"},"workflow instance")," is one running instance of a workflow model--in our case, an individual order to be fulfilled. (",(0,r.kt)("em",{parentName:"li"},(0,r.kt)("a",{parentName:"em",href:"/docs/0.25/product-manuals/zeebe/basics/workflows"},"See: Workflows")),")")),(0,r.kt)("p",null,'For every workflow instance that arrives at the "Initiate Payment" Service Task, Zeebe will create a job with type ',(0,r.kt)("inlineCode",{parentName:"p"},"initiate-payment"),". The external worker service responsible for payment processing--the so-called job worker--will poll Zeebe intermittently to ask if any jobs of type ",(0,r.kt)("inlineCode",{parentName:"p"},"initiate-payment")," are available."),(0,r.kt)("p",null,"If a job is available for a given workflow instance, the worker will activate it, complete it, and notify Zeebe. Zeebe will then advance that workflow instance to the next step in the workflow."),(0,r.kt)("p",null,"Next, we'll add a Message Event to the workflow:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Click on the "Initiate Payment" task on the Modeler'),(0,r.kt)("li",{parentName:"ul"},"Select the circular icon with a double line border"),(0,r.kt)("li",{parentName:"ul"},"Click on the wrench icon next to the newly created event"),(0,r.kt)("li",{parentName:"ul"},"Select the Message Intermediate Catch Event"),(0,r.kt)("li",{parentName:"ul"},'Double-click on the message event and label it "Payment Received"')),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Message Event",src:a(17608).Z})),(0,r.kt)("p",null,"We use message catch events in Zeebe when the workflow engine needs to receive a message from an external system before the workflow instance can advance. (",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("a",{parentName:"em",href:"/docs/0.25/product-manuals/zeebe/bpmn-workflows/message-events/message-events"},"See: Message Events")),")"),(0,r.kt)("p",null,"In the scenario we're modeling, we ",(0,r.kt)("em",{parentName:"p"},"initiate")," a payment with our Service Task, but we need to wait for some other external system to actually confirm that the payment was received. This confirmation comes in the form of a message that will be sent to Zeebe - asynchronously - by an external service."),(0,r.kt)("p",null,"Messages received by Zeebe need to be correlated to specific workflow instances. To make this possible, we have some more configuring to do:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Select the Message Event and make sure you\'re on the "General" tab of the Properties panel on the right side of the screen'),(0,r.kt)("li",{parentName:"ul"},"In the Properties panel, click the ",(0,r.kt)("inlineCode",{parentName:"li"},"+")," icon to create a new message. You'll now see two fields in the Modeler that we'll use to correlate a message to a specific workflow instance: Message Name and Subscription Correlation Key."),(0,r.kt)("li",{parentName:"ul"},"Let's give this message a self-explanatory name: ",(0,r.kt)("inlineCode",{parentName:"li"},"payment-received"),".")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Add Message Name",src:a(38597).Z})),(0,r.kt)("p",null,"When Zeebe receives a message, this name field lets us know ",(0,r.kt)("em",{parentName:"p"},"which message event in the workflow model")," the message is referring to."),(0,r.kt)("p",null,"But how do we know which ",(0,r.kt)("em",{parentName:"p"},"specific workflow instance"),"--that is, which customer order--a message refers to? That's where Subscription Correlation Key comes in. The Subscription Correlation Key is a unique ID present in both the workflow instance payload and the message sent to Zeebe."),(0,r.kt)("p",null,"We'll use ",(0,r.kt)("inlineCode",{parentName:"p"},"orderId")," for our correlation key."),(0,r.kt)("p",null,"Go ahead and add the expression ",(0,r.kt)("inlineCode",{parentName:"p"},"= orderId")," to the Subscription Correlation Key field."),(0,r.kt)("p",null,"When we create a workflow instance, we need to be sure to include ",(0,r.kt)("inlineCode",{parentName:"p"},"orderId")," as a variable, and we also need to provide ",(0,r.kt)("inlineCode",{parentName:"p"},"orderId")," as a correlation key when we send a message."),(0,r.kt)("p",null,"Here's what you should see in the Modeler:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Message Correlation Key",src:a(52416).Z})),(0,r.kt)("p",null,"Next, we'll add an Exclusive (XOR) Gateway to our workflow model. The Exclusive Gateway is used to make a data-based decision about which path a workflow instance should follow. In this case, we want to ship items ",(0,r.kt)("em",{parentName:"p"},"with")," insurance if total order value is greater than or equal to $100 and ship ",(0,r.kt)("em",{parentName:"p"},"without")," insurance otherwise."),(0,r.kt)("p",null,"That means that when we create a workflow instance, we'll need to include order value as an instance variable. But we'll come to that later."),(0,r.kt)("p",null,"First, let's take the necessary steps to configure our workflow model to make this decision. To add the gateway:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click on the Message Event you just created"),(0,r.kt)("li",{parentName:"ul"},"Select the Gateway (diamond-shaped) symbol - the Exclusive Gateway is the default when you add a new gateway to a model"),(0,r.kt)("li",{parentName:"ul"},"Double-click on the gateway and add a label \"Order Value?\" so that it's clear what we're using as our decision criteria")),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Add Exclusive Gateway to Model",src:a(12217).Z})),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Label Exclusive Gateway in Model",src:a(89125).Z})),(0,r.kt)("p",null,"We'll add two outgoing Sequence Flows from this Exclusive Gateway that lead to two different Service Tasks. Each Sequence Flow will have a data-based condition that's evaluated in the context of the workflow instance payload."),(0,r.kt)("p",null,"Next, we need to:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Select the gateway and add a new Service Task to the model."),(0,r.kt)("li",{parentName:"ul"},'Label the task "Ship Without Insurance"'),(0,r.kt)("li",{parentName:"ul"},"Set the Type to ",(0,r.kt)("inlineCode",{parentName:"li"},"ship-without-insurance"))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Add No Insurance Service Task",src:a(57950).Z})),(0,r.kt)("p",null,"Whenever we use an Exclusive Gateway, we want to be sure to set a default flow, which in this case will be shipping without insurance:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Select the Sequence Flow you just created from the gateway to the "Ship Without Insurance" Service Task'),(0,r.kt)("li",{parentName:"ul"},"Click on the wrench icon"),(0,r.kt)("li",{parentName:"ul"},'Choose "Default Flow"')),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Add No Insurance Service Task",src:a(38706).Z})),(0,r.kt)("p",null,"Now we're ready to add a ",(0,r.kt)("em",{parentName:"p"},"second")," outgoing Sequence Flow and Service Task from the gateway:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Select the gateway again"),(0,r.kt)("li",{parentName:"ul"},"Add another Service Task to the model"),(0,r.kt)("li",{parentName:"ul"},'Label it "Ship With Insurance"'),(0,r.kt)("li",{parentName:"ul"},"Set the type to ",(0,r.kt)("inlineCode",{parentName:"li"},"ship-with-insurance"))),(0,r.kt)("p",null,'Next, we\'ll set a condition expression in the Sequence Flow leading to this "Ship With Insurance" Service Task:'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click on the sequence flow and open the Properties panel"),(0,r.kt)("li",{parentName:"ul"},"Input the expression ",(0,r.kt)("inlineCode",{parentName:"li"},"= orderValue >= 100"),' in the "Condition expression" field in the Properties panel'),(0,r.kt)("li",{parentName:"ul"},'Double-click on the sequence flow to add a label "',(0,r.kt)("inlineCode",{parentName:"li"},'>= $100"'))),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Condition Expression",src:a(37542).Z})),(0,r.kt)("p",null,"We're almost finished! To wrap things up, we'll:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'Select the "Ship Without Insurance" task'),(0,r.kt)("li",{parentName:"ul"},"Add another Exclusive Gateway to the model to merge the branches together again (a BPMN best practice in a model like this one)."),(0,r.kt)("li",{parentName:"ul"},'Select the "Ship With Insurance" task'),(0,r.kt)("li",{parentName:"ul"},"Add an outgoing sequence flow that connects to the second Exclusive Gateway you just created")),(0,r.kt)("p",null,"The only BPMN element we need to add is an End Event:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click on the second Exclusive Gateway"),(0,r.kt)("li",{parentName:"ul"},"Add an End Event"),(0,r.kt)("li",{parentName:"ul"},'Double-click on it to label it "Order Fulfilled"')),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Condition Expression",src:a(54369).Z})),(0,r.kt)("p",null,"Lastly, we'll change the process ID to something more descriptive than the default ",(0,r.kt)("inlineCode",{parentName:"p"},"Process_1")," that you'll see in the Modeler:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Click onto a blank part of the canvas"),(0,r.kt)("li",{parentName:"ul"},"Open the Properties panel"),(0,r.kt)("li",{parentName:"ul"},"Change the Id to ",(0,r.kt)("inlineCode",{parentName:"li"},"order-process"))),(0,r.kt)("p",null,"Here's what you should see in the Modeler after these last few updates:"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Update Process ID",src:a(25151).Z})),(0,r.kt)("p",null,"That's all for our modeling step. Remember to save the file one more time to prepare to deploy the workflow to Zeebe, create workflow instances, and complete them."))}d.isMDXComponent=!0},34954:function(e,t,a){"use strict";t.Z=a.p+"assets/files/order-process-aef371ddfb2ff65f51190fa213f5a271.bpmn"},54631:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.0-complete-workflow-ccad27bdd9f510d4fd1314ae560ffff0.png"},7023:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.1-initiate-payment-task-3d7a204208c6f2b42ba8a47c1c6ebdc3.png"},54369:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.10-end-event-099e6b75d1c3be40891b09d36c7cb105.png"},25151:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.11-process-id-bc6ac6cd55b428402175f3c704d966c3.png"},17608:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.2-modeler-message-event-fff88a2499d8f93aac727305a8c50257.png"},38597:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.3-add-message-name-14e574e6781e16189ef1ead6f64c254d.png"},52416:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.4-add-correlation-key-e7f5299f09dd4651effd4017a49f575a.png"},12217:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.5-add-xor-gateway-5cee946d82cde03e75b39b0dc66207bc.png"},89125:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.6-label-xor-gateway-93abf0aa6c3f12efbc136d53c350a36f.png"},57950:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.7-no-insurance-task-4e19ca325ba49fd7cb804faea0ea9301.png"},38706:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.8-default-flow-51c9e64dde97df1d41494e256d885b2e.png"},37542:function(e,t,a){"use strict";t.Z=a.p+"assets/images/tutorial-3.9-condition-expression-3181825ba25f6cd91c4d25a013d5b964.png"}}]);