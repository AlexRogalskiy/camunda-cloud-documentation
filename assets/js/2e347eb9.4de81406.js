(self.webpackChunkcamunda_cloud_documentation=self.webpackChunkcamunda_cloud_documentation||[]).push([[70173],{3905:function(e,t,r){"use strict";r.d(t,{Zo:function(){return p},kt:function(){return m}});var n=r(67294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function l(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=n.createContext({}),s=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},p=function(e){var t=s(e.components);return n.createElement(c.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(r),m=a,f=d["".concat(c,".").concat(m)]||d[m]||u[m]||o;return r?n.createElement(f,i(i({ref:t},p),{},{components:r})):n.createElement(f,i({ref:t},p))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,i=new Array(o);i[0]=d;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var s=2;s<o;s++)i[s]=r[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}d.displayName="MDXCreateElement"},31047:function(e,t,r){"use strict";r.r(t),r.d(t,{frontMatter:function(){return i},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return s},default:function(){return u}});var n=r(22122),a=r(19756),o=(r(67294),r(3905)),i={id:"job-worker",title:"Job worker"},l=void 0,c={unversionedId:"product-manuals/clients/java-client/job-worker",id:"product-manuals/clients/java-client/job-worker",isDocsHomePage:!1,title:"Job worker",description:"Related resources",source:"@site/docs/product-manuals/clients/java-client/job-worker.md",sourceDirName:"product-manuals/clients/java-client",slug:"/product-manuals/clients/java-client/job-worker",permalink:"/docs/product-manuals/clients/java-client/job-worker",editUrl:"https://github.com/camunda-cloud/camunda-cloud-documentation/edit/master/docs/product-manuals/clients/java-client/job-worker.md",version:"current",frontMatter:{id:"job-worker",title:"Job worker"},sidebar:"Product Manuals",previous:{title:"Quick reference",permalink:"/docs/product-manuals/clients/java-client/index"},next:{title:"Logging",permalink:"/docs/product-manuals/clients/java-client/logging"}},s=[{value:"Related resources",id:"related-resources",children:[]},{value:"The Java client&#39;s job worker",id:"the-java-clients-job-worker",children:[]},{value:"Example usage",id:"example-usage",children:[]},{value:"Backoff configuration",id:"backoff-configuration",children:[]}],p={toc:s};function u(e){var t=e.components,r=(0,a.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"related-resources"},"Related resources"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/product-manuals/concepts/job-workers"},"Job worker basics"))),(0,o.kt)("h2",{id:"the-java-clients-job-worker"},"The Java client's job worker"),(0,o.kt)("p",null,"The Java client provides a job worker that handles polling for available jobs. This allows you to focus on writing code to handle the activated jobs."),(0,o.kt)("p",null,"On ",(0,o.kt)("inlineCode",{parentName:"p"},"open"),", the job worker waits ",(0,o.kt)("inlineCode",{parentName:"p"},"pollInterval")," milliseconds and then polls for ",(0,o.kt)("inlineCode",{parentName:"p"},"maxJobsActive")," jobs. It then continues with the following schedule:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"If a poll did not activate any jobs, it waits for ",(0,o.kt)("inlineCode",{parentName:"li"},"pollInterval")," milliseconds and then polls for more jobs."),(0,o.kt)("li",{parentName:"ol"},"If a poll activated jobs, the worker submits each job to the job handler."),(0,o.kt)("li",{parentName:"ol"},"Every time a job is handled, the worker checks whether the number of unhandled jobs have dropped below 30% of ",(0,o.kt)("inlineCode",{parentName:"li"},"maxJobsActive"),". The first time that happens, it will poll for more jobs."),(0,o.kt)("li",{parentName:"ol"},"If a poll fails with an error response, a backoff strategy is applied. This strategy waits for the delay provided by the ",(0,o.kt)("inlineCode",{parentName:"li"},"backoffSupplier")," and polls for more jobs.")),(0,o.kt)("h2",{id:"example-usage"},"Example usage"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/product-manuals/clients/java-client-examples/job-worker-open"},"Open a job worker"))),(0,o.kt)("h2",{id:"backoff-configuration"},"Backoff configuration"),(0,o.kt)("p",null,"When a poll fails with an error response, the job worker applies a backoff strategy. It waits for some time, after which it polls again for more jobs. This gives a Zeebe cluster some time to recover from a failure. In some cases, you may want to configure this backoff strategy to better fit your situation."),(0,o.kt)("p",null,"The retry delay (i.e. the time the job worker waits after an error before the next poll for new jobs) is provided by the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/camunda-cloud/zeebe/blob/develop/clients/java/src/main/java/io/camunda/zeebe/client/api/worker/BackoffSupplier.java"},(0,o.kt)("inlineCode",{parentName:"a"},"BackoffSupplier")),". You can replace it using the ",(0,o.kt)("inlineCode",{parentName:"p"},".backoffSupplier()")," method on the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/camunda-cloud/zeebe/blob/develop/clients/java/src/main/java/io/camunda/zeebe/client/api/worker/JobWorkerBuilderStep1.java"},(0,o.kt)("inlineCode",{parentName:"a"},"JobWorkerBuilder")),"."),(0,o.kt)("p",null,"By default, the job worker uses an exponential backoff implementation, which you can configure using ",(0,o.kt)("inlineCode",{parentName:"p"},"BackoffSupplier.newBackoffBuilder()"),"."),(0,o.kt)("p",null,"The backoff strategy is especially useful for dealing with the ",(0,o.kt)("inlineCode",{parentName:"p"},"GRPC_STATUS_RESOURCE_EXHAUSTED")," error response (see ",(0,o.kt)("a",{parentName:"p",href:"../../../reference/grpc#technical-error-handling"},"gRPC Technical Error Handling"),")."),(0,o.kt)("p",null,"This error code indicates the Zeebe cluster is currently under too large of a load and has decided to reject this request."),(0,o.kt)("p",null,"By backing off, the job worker helps Zeebe by reducing the load."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Zeebe's ",(0,o.kt)("a",{parentName:"p",href:"../../zeebe/deployment-guide/operations/backpressure"},"backpressure mechanism")," can also be configured."))))}u.isMDXComponent=!0}}]);